<nav class='primarynav'>
  <div class='px-1'>
    <button class="text-gray-900 inline-flex mr-2 p-2 hover:bg-gray-900 rounded lg:hidden ml-auto hover:text-white focus:outline-none nav-toggler">
      <i class="fas fa-bars"></i>
    </button>
  </div>

  <div class='logo'>
    <%= link_to root_path do %>
      <%= image_tag "logoblack.png" %>
    <% end %>
  </div>

  <div class='searchbar w-1/5 md:1/2 sm:3/5'>
    <%= form_tag search_path, method: :get do %>
      <div class="search">
        <span class="btn">
          <%= button_tag(type: "submit", class:"icon") do %>
            <i class="fas fa-search"></i>
          <% end %>
        </span>
        <%= text_field_tag :search, params[:search], placeholder: "搜尋商品", class:'inputsearch' %>
      </div>
    <% end %>
  </div>

    <%= link_to carts_path do %>
      <div class='text-gray-900 flex items-center mr-1'><%= image_tag 'bag.png' ,class:'w-8'%>(<%= current_cart.items.count %>) / <%= current_cart.total_price %></div>
    <% end %>

    <div class='hidden top-navbar w-full md:inline-flex md:w-auto text-gray-900 navigation bg-white pl-2 md:space-x-2'>
      <!-- <div><%= link_to '首頁', root_path %></div> -->
      <% if user_signed_in? %>
        <%=link_to '聊聊', rooms_path %>
        <div class='hover:bg-gray-900'><%= link_to '登出' ,  destroy_user_session_path , method: 'delete' %></div>
        <%= link_to carts_path do %>
          <% if current_user %>
            <li data-controller="navcart" data-action="plusbtn@window->navcart#update changequantity@window->navcart#update minusbtn@window->navcart#update usecoupon@window->navcart#update unusecoupon@window->navcart#update">
              <i class="fas fa-shopping-cart"></i> <span class="cartCount" data-navcart-target="cartcount"><%= current_cart.items.count %></span> / <span class="cartTotalPrice" data-navcart-target="carttotalprice"><%= current_cart.total %> </span>
            </li>
          <% else %>
            <%= image_tag current_user.image.url, class:"m-auto rounded-full h-10 w-10" if current_user.image.url.present? %>
          <% end %>
        <% end %>
          <div class='py-4'><%= link_to '登出',  destroy_user_session_path , method: 'delete' %></div>
        <% if current_user.shop.blank? %>
          <div class='py-4'><%= link_to '我要開店', new_shop_path %></div>
        <% else %>
          <div class='py-4'><%= link_to '賣家中心', shops_path %></div>
        <% end %>
        
          <%= link_to user_path(current_user) do %>
            <% if current_user.image.url.blank? %>
              <i class="fas fa-user-circle"></i>
            <% else %>
              <%= image_tag current_user.image.url, class:"m-auto rounded-full h-10 w-10" if current_user.image.url.present? %>
            <% end %>
          <% end %>
      <% else %>
        <div class='py-4 pl-2'><%= link_to '註冊', new_user_registration_path %></div>
        <div class='py-4 pl-2'><%= link_to '登入',  new_user_session_path  %></div>
      <% end %>
    </div>
</nav>




